<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sydney Sweeney</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Sydney Sweeney canvas display">
    <meta name="keywords" content="Sydney Sweeney">
    <meta name="author" content="Abhinav Chinnusamy">
    <meta name="robots" content="noindex, nofollow">

    <!-- Theme Color -->
    <meta name="theme-color" content="#161618">

    <!-- Favicon -->
    <link rel="icon" href="../assets/images/icons/favicon.ico" type="image/x-icon">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            width: 100%;
            background: #161618;
            overflow: hidden;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #161618;
        }

        #sydney-canvas {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 100;
            opacity: 0.7;
        }

        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff6b6b;
            font-size: 18px;
            text-align: center;
            z-index: 100;
            padding: 20px;
            background: rgba(22, 22, 24, 0.9);
            border-radius: 12px;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

    </style>
</head>
<body>
    <div id="canvas-container">
        <canvas id="sydney-canvas"></canvas>
        <div class="loading" id="loading">Loading random image...</div>
        <div class="error-message" id="error" style="display: none;"></div>
    </div>

    <script>
        const canvas = document.getElementById('sydney-canvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('canvas-container');
        const loadingEl = document.getElementById('loading');
        const errorEl = document.getElementById('error');

        // Function to resize canvas
        function resizeCanvas() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            canvas.width = width;
            canvas.height = height;
            
            // Redraw image if it's loaded
            if (window.sydneyImage) {
                drawImage();
            }
        }

        // Function to draw image on canvas - fills full width
        function drawImage() {
            const img = window.sydneyImage;
            const canvasWidth = canvas.width;
            const canvasHeight = canvas.height;
            const imgWidth = img.width;
            const imgHeight = img.height;

            // Scale to fill full width, crop height if needed
            const scale = canvasWidth / imgWidth;
            const scaledWidth = canvasWidth;
            const scaledHeight = imgHeight * scale;

            // Center vertically if image is taller than canvas
            let y = 0;
            if (scaledHeight > canvasHeight) {
                y = (canvasHeight - scaledHeight) / 2;
            }

            // Clear canvas
            ctx.fillStyle = '#161618';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // Draw image filling full width
            ctx.drawImage(img, 0, y, scaledWidth, scaledHeight);
        }

        // Function to fetch random image from Wikipedia
        async function fetchWikipediaImage() {
            try {
                const url = "https://en.wikipedia.org/w/api.php";
                const params = {
                    action: "query",
                    prop: "images",
                    titles: "Sydney Sweeney",
                    format: "json",
                    origin: "*"
                };
                
                // Build URL with parameters
                let queryUrl = url + "?origin=*";
                Object.keys(params).forEach(function(key) {
                    if (key !== 'origin') {
                        queryUrl += "&" + key + "=" + encodeURIComponent(params[key]);
                    }
                });
                
                // Get list of images on the page
                const response = await fetch(queryUrl);
                const data = await response.json();
                
                const pages = data.query.pages;
                const pageId = Object.keys(pages)[0];
                const page = pages[pageId];
                
                if (!page.images || page.images.length === 0) {
                    return null;
                }
                
                // Filter out non-image files (like PDFs, etc.) and get random image
                const imageFiles = page.images.filter(img => {
                    const title = img.title.toLowerCase();
                    return title.includes('.jpg') || title.includes('.jpeg') || 
                           title.includes('.png') || title.includes('.webp');
                });
                
                if (imageFiles.length === 0) {
                    return null;
                }
                
                // Get random image title
                const randomIndex = Math.floor(Math.random() * imageFiles.length);
                const imageTitle = imageFiles[randomIndex].title;
                
                // Now get the actual image URL
                const imageInfoUrl = `https://en.wikipedia.org/w/api.php?origin=*&action=query&titles=${encodeURIComponent(imageTitle)}&prop=imageinfo&iiprop=url&iiurlwidth=1920&format=json`;
                
                const imgResponse = await fetch(imageInfoUrl);
                const imgData = await imgResponse.json();
                
                const imgPages = imgData.query.pages;
                const imgPageId = Object.keys(imgPages)[0];
                const imgPage = imgPages[imgPageId];
                
                if (imgPage.imageinfo && imgPage.imageinfo[0] && imgPage.imageinfo[0].url) {
                    return imgPage.imageinfo[0].url;
                }
                
            } catch (error) {
                console.error('Wikipedia image fetch failed:', error);
            }
            return null;
        }

        // Function to load image from URL
        function loadImage(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                
                img.onload = () => resolve(img);
                img.onerror = () => reject(new Error('Failed to load image'));
                
                img.src = url;
            });
        }

        // Main function to get random image
        async function getRandomImage() {
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';

            // Use Wikipedia API
            const sources = [
                () => fetchWikipediaImage()
            ];

            // Shuffle sources for randomness
            sources.sort(() => Math.random() - 0.5);

            for (const sourceFn of sources) {
                try {
                    const imageUrl = await sourceFn();
                    if (imageUrl) {
                        const img = await loadImage(imageUrl);
                        window.sydneyImage = img;
                        loadingEl.style.display = 'none';
                        resizeCanvas();
                        return;
                    }
                } catch (error) {
                    console.log('Source failed, trying next...', error);
                    continue;
                }
            }

            // If all sources fail, show error
            loadingEl.style.display = 'none';
            errorEl.style.display = 'block';
            errorEl.textContent = 'Unable to load images. Please refresh the page to retry.';
        }

        // Load initial image
        getRandomImage();

        // Auto-refresh every 30 seconds to show new random image
        setInterval(() => {
            getRandomImage();
        }, 30000);

        // Handle window resize
        window.addEventListener('resize', resizeCanvas);

        // Initial resize
        resizeCanvas();
    </script>
</body>
</html>
